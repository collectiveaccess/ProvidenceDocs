



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tracking current object location &mdash; CollectiveAccess 1.7 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/table_override.css" type="text/css" />
  

  
    <link rel="top" title="CollectiveAccess 1.7 documentation" href="../index.html"/>
        <link rel="next" title="Maintaining object use history" href="history.html"/>
        <link rel="prev" title="Access Status" href="access.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> CollectiveAccess
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Introduction to CollectiveAccess</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/whatIs.html">What is CollectiveAccess?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/whoUses.html">Who uses it?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/why.html">Why should I?</a></li>
</ul>
<p class="caption"><span class="caption-text">Setup &amp; Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/systemReq.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/media.html">Media Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/Profiles.html">Profiles</a></li>
</ul>
<p class="caption"><span class="caption-text">How CA Organizes Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../org/records.html">Primary Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/intIDLabel.html">Intrinsics, Identifiers and Labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/metadata.html">Metadata Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/Relationships.html">Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/interstitial.html">Interstitial Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../org/dateTime.html">Date and Time Formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Configuring Providence (Front-End)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../providence/Locales.html">Locales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/listsAuthorities.html">Lists and Authorities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/metadata.html">Metadata Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/interfaces.html">User Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/together.html">Putting It All Together</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/profiles.html">Writing Your Own Installation Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/system.html">System Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providence/identifiers.html">Identifiers</a></li>
</ul>
<p class="caption"><span class="caption-text">Search &amp; Browse</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/intro.html">Intro to Search Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/syntax.html">Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/indexing.html">Indexing Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/engines.html">Search Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/advanced.html">Advanced Search Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/query.html">Query Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../searchBrowse/facets.html">Browse Facets</a></li>
</ul>
<p class="caption"><span class="caption-text">Reporting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reporting/displays.html">Using Displays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting/templates.html">Display Template Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting/export.html">Exporting Search &amp; Browse Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting/pdfOut.html">PDF Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting/labels.html">Generating Labels</a></li>
</ul>
<p class="caption"><span class="caption-text">Workflow</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sets.html">Creating Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="access.html">Access Status</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tracking Current Object Location</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Maintaining Object Use History</a></li>
</ul>
<p class="caption"><span class="caption-text">Import</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../import/tutorial.html">Basic Importer Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/formats.html">Supported File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/mappings.html">Mappings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/running.html">Running an Import</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/worldcat.html">WorldCat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import/getty.html">Getty Vocabularies</a></li>
</ul>
<p class="caption"><span class="caption-text">Export</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../export/formats.html">Supported File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/mappings.html">Mappings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/running.html">Running an Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Administration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administration/control.html">User Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/maint.html">Maintenance Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Customizing Pawtucket</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/intro.html">Introduction to Themes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/general.html">General Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/media.html">Media Display &amp; Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/access.html">Public Access Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/reg.html">Login &amp; Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/static.html">Homepage &amp; Static Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/searchBrowse.html">Search &amp; Browse Pages and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/detail.html">Detail Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/lightbox.html">Lightboxes &amp; Galleries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/classrooms.html">Classrooms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pawtucket/contact.html">Contact &amp; Mail Templates</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/APIs.html">APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/FAQs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Glossaries.html">Glossaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/prior.html">Prior Releases</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">CollectiveAccess</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Tracking current object location</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tracking-current-object-location">
<h1>Tracking current object location<a class="headerlink" href="#tracking-current-object-location" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Prior to version 1.5 collection object location and use history were tracked using standard metadata elements and relationships, in the same ways as other object-level information. Storage locations could be defined hierarchically and objects could be related to specific locations. Additional metadata could be recorded in the object and/or location records. For simple tracking this arrangement worked well enough, but it proved problematic for users seeking to maintain location histories, record complex per-move data (packing, insurance, etc.) or tracking usage across different classes of activity records (eg. loans, exhibitions, conservation, as well as movement). Starting with version 1.5, the available options have been expanded, with specialized tools for tracking location and use history of collection objects. (Of course, existing systems can continue to use the pre-1.5 location tracking methods if they wish.)</p>
<p>One size does not fit all when it comes to location tracking. To handle the range of tracking methodologies required by different types of museum and archival collections CollectiveAccess now offers three different mechanisms to track the location of collection objects:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Direct object-location references.</strong> Location is recorded using relationships between object and storage location records. Relationships are dated, with the most recent date considered &#8220;current&#8221;. This allows construction of simple location histories and is similar to the pre-1.5 method save for the dating.</li>
<li><strong>Movement-based location tracking.</strong> Location is recorded for objects in related movement records. Each movement record records details about a specific change in location for one or more objects. The current location for an object is considered to be the location referred to by the most recent movement by date. Movement of entire storage locations within the location hierarchy can be configured to record a movement, allowing current location tracking based upon individual object moves as well as movements of containers or other storage units.</li>
<li><strong>Workflow-based location tracking.</strong> Location is recorded for an object across a range of record types representing various related activities, including loans, movements, occurrences (typically recording exhibitions), deaccession and location relationships. Locations recorded using direct object-location or movement-based location tracking can be part of the range of data used by to derive current location.</li>
</ul>
</div></blockquote>
<p>Although it is possible to simultaneously employ more than one of these mechanisms in your system, in general you should choose only one to use.</p>
</div>
<div class="section" id="which-method-should-i-use">
<h2>Which method should I use?<a class="headerlink" href="#which-method-should-i-use" title="Permalink to this headline">¶</a></h2>
<p><strong>Direct object-location</strong> reference is the simplest option and is suitable for collections that have fairly uniform location reporting requirements. If everything in your collection has a standard location and there are relatively informal movements of items between locations use this option. Many archives, historical societies and house museums and the like will find this an effective and easy to deploy option.</p>
<p><strong>Movement-based location tracking</strong> records detailed information about how one or more objects are transferred between locations, in addition to the location history. This option is intended for collections where documenting chain of custody, insurance and packing are critical. This additional documentation comes at the expense of added complexity and additional required data entry. Every movement of an object or group of objects to a new location requires completion of a full movement record. Collections that routinely move valuable, sensitive or fragile materials (fine art museums, artists studios, archives with privacy concerns) may find this option preferable.</p>
<p><strong>Workflow-based location tracking</strong> is designed for institutions with a robust notion of location and expands upon either of the preceding two options. In contrast with other methods, which all record relationships between objects and locations (with or without movements), workflow-based location tracking takes into consideration several types of records to determine the current location of an object, including direct object-location or movement-based tracking. With this method location can be based upon a combination of reported storage location, occurrence (often an exhibition or event), loan, movement or deaccession. For institutions that often loan or exhibit objects workflow-based tracking can reduce redundant data entry by using the loan or exhibition record itself as documentation of location, rather than requiring hacky double entry and pseudo &#8220;loan&#8221; or &#8220;on exhibit&#8221; storage locations. This flexibility comes at the cost of more complex configuration and, potentially, additional required data entry.</p>
<p>For most users direct object-location tracking should be sufficient. Movement-based or workflow-based location tracking should only be considered if you require the specific functionality they provide.</p>
</div>
<div class="section" id="direct-object-location-reference">
<h2>Direct object-location reference<a class="headerlink" href="#direct-object-location-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>Basic configuration of object-location tracking is done in app.conf using the following directives:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">App.conf Setting Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>object_storage_location_tracking_relationship_type</td>
<td>A single relationship type (identified by alphanumeric type code) used to indicate an object storage location. Must be set to a valid object-storage location relationship type.</td>
</tr>
</tbody>
</table>
<p>There are two bundles available to implement location tracking in your editing user interfaces. The <strong>ca_objects_location</strong> bundle displays the current location, location history and adds a control to change the current location in the object editor.</p>
<p>The <strong>ca_objects_location</strong> bundle provides the following options when used with direct object-location tracking. These can be set in your installation profile or in the web-based configuration UI:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting Name</th>
<th class="head">Name in UI</th>
<th class="head">Description</th>
<th class="head">Values</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>locationTrackingMode</td>
<td>Track location using</td>
<td>Determines whether the bundle uses object-location references or movements to track object location.</td>
<td>ca_storage_locations for direct object-location references; ca_movements for movement-based tracking</td>
<td>ca_movements</td>
</tr>
<tr class="row-odd"><td>displayTemplate</td>
<td>Object location display template</td>
<td>Layout for current location of object when displayed in list (can include HTML). The template is evaluated relative to the object-movement or object-storage location relationship that is current. Element code tags prefixed with the ^ character can be used to represent the value in the template. For example: ^ca_storage_locations.preferred_labels.name (moved on ^ca_objects_x_storage_locations.effective_date).</td>
<td>Valid display template.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>historyTemplate</td>
<td>Object location history template</td>
<td>Layout for each previous location of object when displayed in history list (can include HTML). The template is evaluated relative to the object-movement or object-storage location relationship. Element code tags prefixed with the ^ character can be used to represent the value in the template. For example: ^ca_storage_locations.preferred_labels.name (moved on ^ca_objects_x_storage_locations.effective_date).</td>
<td>Valid display template.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>currentLocationColor</td>
<td>Color for current location</td>
<td>Color to use as highlight for the current location in the location history and in the current location tab.</td>
<td>Hex color with leading hash (#)</td>
<td>#eeeeee</td>
</tr>
<tr class="row-even"><td>pastLocationColor</td>
<td>Color for current location</td>
<td>Color to use as highlight for the pasts location in the location history.</td>
<td>Hex color with leading hash (#)</td>
<td>#eeeeee</td>
</tr>
<tr class="row-odd"><td>futureLocationColor</td>
<td>Color for current location</td>
<td>Color to use as highlight for future-dated locations in the location history.</td>
<td>Hex color with leading hash (#)</td>
<td>#eeeeee</td>
</tr>
<tr class="row-even"><td>useHierarchicalBrowser</td>
<td>Use hierarchy browser for storage locations?</td>
<td>If set a hierarchical browser will be used to select storage location items; if not set an auto-complete lookup will be used.</td>
<td>0 or 1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The <strong>ca_storage_locations_contents</strong> will display a list of all objects currently resident in a storage location. It provides the following options, which can be set in your installation profile or in the web-based configuration UI:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting Name</th>
<th class="head">Name in UI</th>
<th class="head">Description</th>
<th class="head">Values</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>list_format</td>
<td>Format of contents list</td>
<td>Format used to display location contents listing.</td>
<td>list for a list of objects; bubbles for left-floated bubbles</td>
<td>bubbles</td>
</tr>
<tr class="row-odd"><td>locationTrackingMode</td>
<td>Track location using</td>
<td>Determines whether the bundle uses object-location references or movements to track object location.</td>
<td>ca_storage_locations for direct object-location references; ca_movements for movement-based tracking</td>
<td>ca_movements</td>
</tr>
<tr class="row-even"><td>displayTemplate</td>
<td>Display template</td>
<td>Layout for each object in the storage location (can include HTML). The template is evaluated relative to each object-movement or object-location relationship. Element code tags prefixed with the ^ character can be used to represent the value in the template. For example: ^ca_objects.prefered_labels,name (^ca_objects.idno).</td>
<td>Valid display template.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>colorItem</td>
<td>Object color</td>
<td>Color to use as highlight for each object in the storage location.</td>
<td>Hex color with leading hash (#)</td>
<td>#ffffff</td>
</tr>
</tbody>
</table>
<p>Note that when using direct object-location tracking, a ca_storage_locations relationship bundle placed in an object editor will display all object-location links, past, present and future, in a single undifferentiated list and can be configured to allow users to add object-location links. The ca_objects relationship bundle placed in a storage location editor will behave similarly. In general, the ca_objects and ca_storage_locations relationship bundles should not be placed in the storage location and objects editors respectively when direct object-location tracking is in use.</p>
</div>
</div>
<div class="section" id="movement-based-location-tracking">
<h2>Movement-based location tracking<a class="headerlink" href="#movement-based-location-tracking" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Basic configuration of movement-based location tracking is done in app.conf using the following directives:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">App.conf Setting Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>movement_storage_location_tracking_relationship_type</td>
<td>A single relationship type (identified by alphanumeric type code) used to indicate a movement storage location. Must be set to a valid movement-storage location relationship type.</td>
</tr>
<tr class="row-odd"><td>movement_object_tracking_relationship_type</td>
<td>A single relationship type (identified by alphanumeric type code) used to link an object to a movement for tracking purposes. Must be set to a valid object-movement relationship type.</td>
</tr>
<tr class="row-even"><td>movement_storage_location_date_element</td>
<td>The movement DateRange metadata element that stores the date the movement was executed. This is the date the movement was actually performed, not the date the record was created. Use the alphanumeric metadata element code without the table name. For example, if the element is ca_movements.date_of_move set this to date_of_move</td>
</tr>
<tr class="row-odd"><td>record_movement_information_when_moving_storage_location</td>
<td>If set a movement record will be generated for all objects currently in the storage location when the location itself is moved within the location hierarchy</td>
</tr>
</tbody>
</table>
<p>As with direct object-location tracking there are two bundles available to implement location tracking in your editing user interfaces. The ca_objects_location bundle displays the current location, location history and adds a control to change the current location in the object editor. The options are the same as for object-location tracking, but the locationTrackingMode option should be set to ca_movements.</p>
<p>The location of an object will be updated when any of the following occur:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The location of an object is changed using the object location bundle in the object editor</li>
<li>A storage location is moved within the location hierarchy and the record_movement_information_when_moving_storage_location option is app.conf is set</li>
<li>A movement record is manually created, a storage location is set for it and objects added to it</li>
</ol>
</div></blockquote>
<p>Note that changing the storage location of an existing movement will change the storage location for all objects associated with that movement but not the date. It will be as if the new location had been chosen on the movement date.</p>
</div>
</div>
<div class="section" id="workflow-based-location-tracking">
<h2>Workflow-based location tracking<a class="headerlink" href="#workflow-based-location-tracking" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Configuration<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Unlike other location tracking options, which explicitly record location in a specific place in the database, workflow-based location tracking calculates the current location of an object by looking at a range of related records, comparing their dates, and selecting the most recently dated. What types of records are considered and which date elements in those records are used for comparison are entirely configurable.</p>
<p>Workflow-based location tracking can supplement direct object-location reference or movement-based tracking. That is, locations recorded with those two methods may be part of the mix of records workflow-based tracking considers when calculating the current location, but they don&#8217;t have to be.</p>
<p>Primary configuration is done in <strong>app.conf</strong> through the <strong>current_location_criteria</strong> directive. current_location_criteria is an associative array the keys of which are the primary types you want considered. Relevant primary types for location tracking are: ca_storage_locations, ca_loans, ca_movements, ca_object_lots and ca_occurrences. Each primary type has a sub-array the keys of which are sub-types (except for ca_storage_locations for which it is a relationship type). Each sub-type/relationship type in turn has an array of options. For example:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>current_location_criteria = {</dt>
<dd><dl class="first docutils">
<dt>ca_storage_locations = {</dt>
<dd><dl class="first docutils">
<dt>related = {</dt>
<dd>template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>},
ca_movements = {</p>
<blockquote>
<div>shipping = { date = pickup_date, color = 9bae33 },
framing = { date = pickup_date, color = 541353 },
conservation = { date = pickup_date, color = 245442 },
administrative = { date = pickup_date, color = 992222 },</div></blockquote>
<p>},
ca_loans = {</p>
<blockquote>
<div><dl class="docutils">
<dt>collection = {</dt>
<dd>date = loan_period,
color = cccccc</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
ca_occurrences = {</p>
<blockquote>
<div><dl class="docutils">
<dt>exhibition = {</dt>
<dd>date = exh_dates,
color = 00cc00</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
# The entry for ca_objects controls if and how deaccessions are displayed
ca_objects = {</p>
<blockquote>
<div>template = ^ca_objects.deaccession_notes (^ca_objects.deaccession_date),
color = cc0000</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
<p>In this example, ca_movements is a primary type, shipping is a movement sub-type and date is an option for the shipping sub-type (and others as well) specifying what date element should be used to calculate this movement sub-types place in the object&#8217;s history. (For the ca_storage_locations primary type in the example, related is an object-storage location relationship type, and template is an option of that relationship type).</p>
<p>Note that display of deaccessions (managed via the ca_objects_deaccession editor bundle) in the object use history is controlled using the ca_objects primary type. If it is present in the configuration deaccessions will be shown, formatted using the supplied template and color, as in the example above.</p>
<p>Sub-type/relationship type options affect both the what is considered current and how the current location is displayed. Options include:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option Name</th>
<th class="head">Description</th>
<th class="head">Mandatory?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>template</td>
<td>A display template evaluated relative to the related record when it is calculated to be current</td>
<td>No. Will default to displaying the preferred label of the record</td>
</tr>
<tr class="row-odd"><td>date</td>
<td>The code of the DateRange metadata element used when calculating current location.</td>
<td>Yes for all primary types except ca_storage_locations, for which date is derived from the object-storage location relationship.</td>
</tr>
<tr class="row-even"><td>color</td>
<td>A color to highlight entries of this type with. Should be six-digit hex color</td>
<td>No</td>
</tr>
</tbody>
</table>
<p>This configuration will be used to display current location in the editor inspectors, when browsing on workflow-based current location and by default in the Object Use History (ca_objects_history) editor bundle.</p>
<p>The Object Use History bundle is used to display the current location as well as a detailed history of previous use. It is intended as a convenient means to show where an object is and has been, but can also be configured to show any set of related records by date. The bundle has a variety of settings to customize the layout and contents of the location stream. All of these can be set in the current_location_criteria bundle in app.conf, described previously, and used as defaults in the bundle. Let&#8217;s take a look at an example:</p>
<p>In the bundle seen above the cataloguer has configured different colors and templates to showcase Accession, Loan, and Storage Location activity and data. Each block is automatically sorted by the date chosen through the bundle settings for that table. For example, Artwork loans are sorted on the &#8220;Loan Period&#8221; as seen via the dates on the far right-hand side. When a new relationship is created to any of the three configured tables a new segment will appear in the stream in the appropriate order based on date. In addition to the tables shown in the example, Occurrences, Movements, and Deaccessions can also be configured.</p>
<p>The contents of each block in the stream are entirely configurable using metadata display templates. With this powerful syntax any metadata from the related record, or from those records related to the related record, can be displayed in the Use History bundle. An example of that relationship traversing can be seen above in the Artwork loan blocks. There, the &#8220;Borrower&#8221; is displayed using the below syntax which pulls entities related to the related loan:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>&lt;l&gt;^ca_loans.preferred_labels&lt;/l&gt;&lt;br&gt;
&lt;ifdef code=&#8221;ca_loans.loan_period&#8221;&gt;Loan Period:&lt;/ifdef&gt; ^ca_loans.loan_period&lt;br&gt;
Borrower: &lt;unit relativeTo=&#8221;ca_loans&#8221;&gt;
&lt;unit relativeTo=&#8221;ca_entities&#8221; delimiter=&#8221;, &#8221; restrictToRelationshipTypes=&#8221;borrower&#8221;&gt;^ca_entities.preferred_labels&lt;/unit&gt;&lt;/unit&gt;</p>
<p>Configuring bundle-specific settings through an installation profile</p>
<p>To add the Use History bundle to the installation profile, simply include the bundle placement and relevant settings on the appropriate UI screen. The use history settings defined in app.conf are taken as a system-wide universal, but defining the ca_objects_history setting in the profile allows for UI-specific customizations.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&lt;placement code=&quot;ca_objects_history&quot;&gt;
  &lt;bundle&gt;ca_objects_history&lt;/bundle&gt;
  &lt;settings&gt;
    &lt;setting name=&quot;ca_object_lots_purchase_dateElement&quot;&gt;accession_date&lt;/setting&gt;
    &lt;setting name=&quot;ca_object_lots_purchase_color&quot;&gt;#663A8C&lt;/setting&gt;
  &lt;/settings&gt;
&lt;/placement&gt;
</pre></div>
</div>
<p>The chart below lists settings per table that can be included in your profile. Be sure to replace #type# with the custom type configured in your profile. For example, if &#8220;purchase&#8221; was the item idno in your list ca_object_lot_types, then your setting would be: ca_object_lots_purchase_dateElement.</p>
<p>Note that there is no dateElement setting for storage locations. Storage locations are sorted on the date cataloged.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hide_add_to_loan_controls</td>
<td>Set to 1 if you want to to hide the &#8220;Add to loan&#8221; controls in this bundle placement. Defaults to 0</td>
</tr>
<tr class="row-odd"><td>hide_update_location_controls</td>
<td>Set to 1 if you want to to hide the &#8220;Update Location&#8221; controls in this bundle placement. Defaults to 0</td>
</tr>
<tr class="row-even"><td>useHierarchicalBrowser</td>
<td>Set to 1 if you want to provide an hierarchical browser when searching for an updated storage location</td>
</tr>
<tr class="row-odd"><td>locationTrackingMode</td>
<td>Sets method for tracking location of object within storage location hierarchy. Set to ca_storage_locations to use direct object-location references; set to ca_movements to use movement-based location tracking</td>
</tr>
<tr class="row-even"><td>useAppConfDefaults</td>
<td>Set to 1 if you want to use the app.conf current_location_criteria settings. If you want to set specific settings for this bundle then set this to 0 and specify values for that various settings below</td>
</tr>
<tr class="row-odd"><td>ca_object_lots_showTypes</td>
<td>Sets which object lots types appear in the use history stream. For all showTypes settings, repeat once for each type that should be included. Use the item idno i.e. &lt;setting name=&#8221;ca_object_lots_showTypes&#8221;&gt;purchase&lt;/setting&gt;</td>
</tr>
<tr class="row-even"><td>ca_object_lots_#type#_dateElement</td>
<td>Sets the date field that is used to sort object lots of this type in the use history stream.</td>
</tr>
<tr class="row-odd"><td>ca_object_lots_#type#_color</td>
<td>Sets the color for this type of object lot. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-even"><td>ca_object_lots_#type#_displayTemplate</td>
<td>Sets the template for metadata displayed for this type of object lot in the use history stream.</td>
</tr>
<tr class="row-odd"><td>ca_occurrences_showTypes</td>
<td>Sets which occurrence types appear in the use history stream.</td>
</tr>
<tr class="row-even"><td>ca_occurrences_#type#_dateElement</td>
<td>Sets the date field that is used to sort this type of occurrence in the use history stream.</td>
</tr>
<tr class="row-odd"><td>ca_occurrences_#type#_color</td>
<td>Sets the color for this type of occurrence. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-even"><td>ca_occurrences_#type#_displayTemplate</td>
<td>Sets the template for metadata displayed for this type of occurrence in the use history stream</td>
</tr>
<tr class="row-odd"><td>ca_movements_showTypes</td>
<td>Sets which movement types appear in the use history stream.</td>
</tr>
<tr class="row-even"><td>ca_movements_#type#_dateElement</td>
<td>Sets the date field that is used to sort this type of movement in the use history stream.</td>
</tr>
<tr class="row-odd"><td>ca_movements_#type#_color</td>
<td>Sets the color for this type of movement. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-even"><td>ca_movements_#type#_displayTemplate</td>
<td>Sets the template for metadata displayed for this type of movement in the use history stream</td>
</tr>
<tr class="row-odd"><td>ca_loans_showTypes</td>
<td>Sets which loan types appear in the use history stream.</td>
</tr>
<tr class="row-even"><td>ca_loans_#type#_dateElement</td>
<td>Sets the date field that is used to sort this type of loan in the use history stream.</td>
</tr>
<tr class="row-odd"><td>ca_loans_#type#_color</td>
<td>Sets the color for this type of loan. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-even"><td>ca_loans_#type#_displayTemplate</td>
<td>Sets the template for metadata displayed for this type of loan in the use history stream</td>
</tr>
<tr class="row-odd"><td>ca_storage_locations_showRelationshipTypes</td>
<td>Sets which related storage locations will appear.</td>
</tr>
<tr class="row-even"><td>ca_storage_locations_color</td>
<td>Sets the color for all storage locations types. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-odd"><td>ca_storage_locations_displayTemplate</td>
<td>Sets the template for metadata displayed for storage locations of all types.</td>
</tr>
<tr class="row-even"><td>showDeaccessionInformation</td>
<td>Sets whether or not Deaccessions are included in the stream. 1 = yes; 0 = no.</td>
</tr>
<tr class="row-odd"><td>deaccession_color</td>
<td>Sets the color for deaccessions. Use hex colors with no pound sign, i.e. &#8220;B1AAF2&#8221;</td>
</tr>
<tr class="row-even"><td>deaccession_displayTemplate</td>
<td>Sets the template for deaccessions.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="browsing-by-current-location">
<h2>Browsing by current location<a class="headerlink" href="#browsing-by-current-location" title="Permalink to this headline">¶</a></h2>
<p>Workflow-based location tracking will cache the current location of the object within the object record, which makes browsing possible. To set up a current location browse add a facet of type location in browse.conf. For example:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>current_location = {</dt>
<dd><blockquote class="first">
<div><p>type = location,
restrict_to_types = [],</p>
<p>group_mode = none,</p>
<dl class="docutils">
<dt>collapse = {</dt>
<dd>ca_loans = On loan,
ca_movements/conservation = In conservation,
ca_movements/shipping = Shipped,
ca_movements/administrative = Consigned</dd>
</dl>
<p>},</p>
<dl class="docutils">
<dt>display = {</dt>
<dd><dl class="first docutils">
<dt>ca_storage_locations = {</dt>
<dd>related = { template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_ (storage) }</dd>
</dl>
<p>},
ca_occurrences = {</p>
<blockquote>
<div>exhibition = { template = ^ca_occurrences.preferred_labels.name (exhibition) }</div></blockquote>
<p class="last">},</p>
</dd>
</dl>
<p>},
maximumBrowseDepth = 1,
include_none_option = No location specified,</p>
<p>label_singular = _(&#8220;current location&#8221;),
label_plural = _(&#8220;current location&#8221;)</p>
</div></blockquote>
<p class="last">},</p>
</dd>
</dl>
<p>The collapse, display, maximumBrowseDepth and include_none_option directives are specific to location facets:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Directive</th>
<th class="head">Description</th>
<th class="head">Mandatory?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>collapse</td>
<td>The facet will list entries for each distinct storage location. By default this means the each individual loan, movement, storage location or occurrence will be listed in the facet. For storage locations and occurrences this usually exactly what you want. Listing individual loans and movements, however, often results in a long list of undifferentiated values that makes effective browsing difficult. collapse&#8217; directs the browse to consolidate all records of a given type (and optionally) sub-type into a single generic facet value. In the example above, collapsing onca_loansresults in all objects for which the current location is a loan being browsable via a single &#8220;On loan&#8221; facet item. For movements, facet items are presented for individual movement sub-types.</td>
<td>No.</td>
</tr>
<tr class="row-odd"><td>display</td>
<td>Sets the display template used to generate the facet item for the specified type and sub-type (or in the case of storage locations, type and relationship type). Each template is generated relative to the related record.</td>
<td>No.</td>
</tr>
<tr class="row-even"><td>include_none_option</td>
<td>Enable browsing for objects that have no current location set. The values of this directive will be used as the text of the facet item.</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>maximumBrowseDepth</td>
<td>As of version 1.7: Enables the bucketing of storage locations into top-level facets. Child locations are grouped by their parent, based on the depth set through this configuration. A browse at the parent level will be inclusive of all child locations. For example, objects currently stored in the locations: Offsite Storage &gt; Room 1 and Offsite Storage &gt; Room 2 will return when a user browses on Offsite Storage if the maximumBrowseDepth is set to 1.</td>
<td>No</td>
</tr>
</tbody>
</table>
<div class="section" id="updating-the-cache">
<h3>Updating the cache<a class="headerlink" href="#updating-the-cache" title="Permalink to this headline">¶</a></h3>
<p>For performance reasons, the current location of the object is cached within the object record itself. Since locations are calculated based upon the settings in the app.conf current_location_criteria directive, and change in current_location_criteria will likely invalidate the cached data. To regenerate the cache and ensure accurate browse results be sure to run the following caUtils command on the command line:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>bin/caUtils reload-object-current-locations</p>
</div>
<div class="section" id="browsing-current-location-when-using-non-workflow-based-location-tracking-options">
<h3>Browsing current location when using non-workflow-based location tracking options<a class="headerlink" href="#browsing-current-location-when-using-non-workflow-based-location-tracking-options" title="Permalink to this headline">¶</a></h3>
<p>Browsing on current location is only supported in workflow-based location tracking. Since workflow-based location tracking supplements the other tracking options, enabling browse for any kind of location tracking involves setting up a minimal workflow-based configuration like this:</p>
<p>In app.conf, if you are using direct object-location location tracking:
.. code-block:: none</p>
<dl class="docutils">
<dt>current_location_criteria = {</dt>
<dd><dl class="first docutils">
<dt>ca_storage_locations = {</dt>
<dd><dl class="first docutils">
<dt>[relationship type] = {</dt>
<dd>template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
<p>where [relationship type] is set to whatever you have object_storage_location_tracking_relationship_type in app.conf set to.</p>
<p>If you are using movement-based location tracking then:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>current_location_criteria = {</dt>
<dd><dl class="first docutils">
<dt>ca_movements = {</dt>
<dd><dl class="first docutils">
<dt>[movement type] = {</dt>
<dd>date = pickup_date,
template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
<p>where [movement type] is a type of movement you want considered as indicating current location. You can list more than one type if needed.</p>
<p>Then in browse.conf add a facet definition like this for direct object-location tracking:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>current_location = {</dt>
<dd><blockquote class="first">
<div><p>type = location,
restrict_to_types = [],</p>
<p>group_mode = none,</p>
<dl class="docutils">
<dt>display = {</dt>
<dd><dl class="first docutils">
<dt>ca_storage_locations = {</dt>
<dd>[relationship type] = { template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_ (storage) }</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>},</p>
<p>include_none_option = No location specified,</p>
<p>label_singular = _(&#8220;current location&#8221;),
label_plural = _(&#8220;current location&#8221;)</p>
</div></blockquote>
<p class="last">},</p>
</dd>
</dl>
<p>where [relationship type] is set to whatever you have object_storage_location_tracking_relationship_type in app.conf set to.</p>
<p>For movement-based tracking:
.. code-block:: none</p>
<dl class="docutils">
<dt>current_location = {</dt>
<dd><blockquote class="first">
<div><p>type = location,
restrict_to_types = [],</p>
<p>group_mode = none,</p>
<dl class="docutils">
<dt>display = {</dt>
<dd><dl class="first docutils">
<dt>ca_movements = {</dt>
<dd>[movement type] = { template = ^ca_storage_locations.hierarchy.preferred_labels%delimiter=_➜_ (storage) }</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>},</p>
<p>include_none_option = No location specified,</p>
<p>label_singular = _(&#8220;current location&#8221;),
label_plural = _(&#8220;current location&#8221;)</p>
</div></blockquote>
<p class="last">},</p>
</dd>
</dl>
<p>where [movement type] is a type of movement you want considered as indicating current location. You can list more than one type if needed.
General maintenance</p>
<p>Both direct object-location and movement-based location tracking rely on dates embedded in relationships between related records. If you are updating an older system, change app.conf configuration or otherwise have reason to believe these dates may be out of sync with the underlying movement and location data from which they are derived you can run the following caUtils command on the command line to refresh values:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>bin/caUtils reload-object-current-location-dates</p>
<p>For most data sets this command should take only seconds to a few minutes to run and will not have adverse effects. If you are getting odd ordering in use histories or display of current location try running this command to resolve the issues.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="history.html" class="btn btn-neutral float-right" title="Maintaining object use history" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="access.html" class="btn btn-neutral" title="Access Status" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Whirl-i-Gig.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>